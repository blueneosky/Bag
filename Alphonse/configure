#!/bin/bash

ALPHONSE_SERVICE=no
ALPHONSE_WEB=no
source ./Config

#TODO remove that echos
#echo "$ALPHONSE_BIN_DIR"
#echo "$ALPHONSE_DATA_DIR"
#echo "$ALPHONSE_SERVICE"
#echo "$ALPHONSE_SERVICE_DIR"
#echo "$ALPHONSE_WEB"
#echo "$ALPHONSE_WWW_DIR"
#echo "$ALPHONSE_CGI_BIN_DIR"

SED_FUNC="s#{{ALPHONSE_BIN_DIR}}#$ALPHONSE_BIN_DIR#g"
SED_FUNC="$SED_FUNC; s#{{ALPHONSE_DATA_DIR}}#$ALPHONSE_DATA_DIR#g"
SED_FUNC="$SED_FUNC; s#{{ALPHONSE_SERVICE_DIR}}#$ALPHONSE_SERVICE_DIR#g"
SED_FUNC="$SED_FUNC; s#{{ALPHONSE_WWW_DIR}}#$ALPHONSE_WWW_DIR#g"
SED_FUNC="$SED_FUNC; s#{{ALPHONSE_CGI_BIN_DIR}}#$ALPHONSE_CGI_BIN_DIR#g"

if [ $ALPHONSE_SERVICE = "yes" ]; then
  SED_FUNC="$SED_FUNC; s#\\[@1\\]##g"
else
  SED_FUNC="$SED_FUNC; /^\[@1\]/d"
fi

if [ $ALPHONSE_WEB = "yes" ]; then
  SED_FUNC="$SED_FUNC; s#\\[@2\\]##g"
else
  SED_FUNC="$SED_FUNC; /^\[@2\]/d"
fi

sed "$SED_FUNC" alphonse.conf.in > alphonse.conf
sed "$SED_FUNC" alphonse.service.in > alphonse.service
sed "$SED_FUNC" Makefile.in > Makefile

